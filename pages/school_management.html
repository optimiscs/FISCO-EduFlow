<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>高校管理平台 - 学链通</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../styles/school_management.css">
</head>
<body>
    <div class="dashboard-container">
        <!-- 左侧导航栏 -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo-icon">
                    <svg viewBox="0 0 24 24">
                        <path d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M12,5A3,3 0 0,1 15,8A3,3 0 0,1 12,11A3,3 0 0,1 9,8A3,3 0 0,1 12,5M17.13,17C15.92,18.85 14.11,20.24 12,20.92C9.89,20.24 8.08,18.85 6.87,17C6.53,16.5 6.24,16 6,15.47C6,13.82 8.71,12.47 12,12.47C15.29,12.47 18,13.79 18,15.47C17.76,16 17.47,16.5 17.13,17Z"/>
                    </svg>
                </div>
                <span class="logo-text">学链通</span>
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="#dashboard" class="nav-link active">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M13,3V9H21V3M13,21H21V11H13M3,21H11V15H3M3,13H11V3H3V13Z" />
                        </svg>
                        <span>仪表盘</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#students" class="nav-link">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" />
                        </svg>
                        <span>学生管理</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#certificates" class="nav-link">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M4,3C2.89,3 2,3.89 2,5V15A2,2 0 0,0 4,17H12V22L15,19L18,22V17H20A2,2 0 0,0 22,15V8L22,6V5A2,2 0 0,0 20,3H16V3H4M12,5L15,7L18,5V8.5L21,10L18,11.5V15L15,13L12,15V11.5L9,10L12,8.5V5M4,5H9V7H4V5M4,9H7V11H4V9M4,13H9V15H4V13Z" />
                        </svg>
                        <span>证书管理</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#uploads" class="nav-link">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M14,13V17H10V13H7L12,8L17,13M19.35,10.03C18.67,6.59 15.64,4 12,4C9.11,4 6.6,5.64 5.35,8.03C2.34,8.36 0,10.9 0,14A6,6 0 0,0 6,20H19A5,5 0 0,0 24,15C24,12.36 21.95,10.22 19.35,10.03Z" />
                        </svg>
                        <span>批量上传</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#audit" class="nav-link">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1Z" />
                        </svg>
                        <span>审核管理</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#data" class="nav-link">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M3,4H7V8H3V4M9,5V7H21V5H9M3,10H7V14H3V10M9,11V13H21V11H9M3,16H7V20H3V16M9,17V19H21V17H9" />
                        </svg>
                        <span>数据报表</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#settings" class="nav-link">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z" />
                        </svg>
                        <span>系统设置</span>
                    </a>
                </li>
            </ul>
            <div class="sidebar-footer" style="padding: 20px; border-top: 1px solid rgba(255, 255, 255, 0.1); margin-top: auto;">
                <a href="../login.html" class="nav-link" style="justify-content: flex-start; padding: 10px 0;">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M16,17V14H9V10H16V7L21,12L16,17M14,2A2,2 0 0,1 16,4V6H14V4H5V20H14V18H16V20A2,2 0 0,1 14,22H5A2,2 0 0,1 3,20V4A2,2 0 0,1 5,2H14Z" />
                    </svg>
                    <span>退出登录</span>
                </a>
            </div>
        </aside>
        
        <!-- 主内容区域 -->
        <div class="main-content">
            <!-- 顶部状态栏 -->
            <div class="topbar">
                <h1 class="page-title">高校管理平台</h1>
                <div class="user-menu">
                    <div class="notification-icon">
                        <svg viewBox="0 0 24 24" width="22" height="22" fill="currentColor">
                            <path d="M21,19V20H3V19L5,17V11C5,7.9 7.03,5.17 10,4.29C10,4.19 10,4.1 10,4A2,2 0 0,1 12,2A2,2 0 0,1 14,4C14,4.1 14,4.19 14,4.29C16.97,5.17 19,7.9 19,11V17L21,19M14,21A2,2 0 0,1 12,23A2,2 0 0,1 10,21M19.75,3.19L18.33,4.61C20.04,6.3 21,8.6 21,11H23C23,8.07 21.84,5.25 19.75,3.19M1,11H3C3,8.6 3.96,6.3 5.67,4.61L4.25,3.19C2.16,5.25 1,8.07 1,11Z"/>
                        </svg>
                        <span class="notification-badge">3</span>
                    </div>
                    <div class="user-profile">
                        <div class="user-avatar">
                            <span>北</span>
                        </div>
                        <div class="user-info">
                            <div class="user-name">学链通大学</div>
                            <div class="user-role">高校管理员</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 内容区域 -->
            <div class="content-wrapper">
                <!-- 默认显示的学历管理内容（将被JavaScript隐藏） -->
                <div id="default-content" style="display: none;">
                <!-- 统计概览区域 -->
                <div class="row">
                    <div class="col col-3">
                        <div class="stat-card" style="background: linear-gradient(45deg, #3A7BD5, #00d2ff);">
                            <div class="stat-title">总学生数量</div>
                            <div class="stat-value">24,856</div>
                            <div class="stat-description">较上月增长 2.4%</div>
                            <div class="stat-icon">
                                <svg viewBox="0 0 24 24" width="80" height="80" fill="currentColor">
                                    <path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" />
                                </svg>
                            </div>
                        </div>
                    </div>
                    <div class="col col-3">
                        <div class="stat-card" style="background: linear-gradient(45deg, #11998e, #38ef7d);">
                            <div class="stat-title">已上链学历数</div>
                            <div class="stat-value">18,634</div>
                            <div class="stat-description">覆盖率 74.9%</div>
                            <div class="stat-icon">
                                <svg viewBox="0 0 24 24" width="80" height="80" fill="currentColor">
                                    <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" />
                                </svg>
                            </div>
                        </div>
                    </div>
                    <div class="col col-3">
                        <div class="stat-card" style="background: linear-gradient(45deg, #FF512F, #F09819);">
                            <div class="stat-title">待审核申请</div>
                            <div class="stat-value">126</div>
                            <div class="stat-description">较上周增加 15 个</div>
                            <div class="stat-icon">
                                <svg viewBox="0 0 24 24" width="80" height="80" fill="currentColor">
                                    <path d="M13,2.03V2.05L13,4.05C17.39,4.59 20.5,8.58 19.96,12.97C19.5,16.61 16.64,19.5 13,19.93V21.93C18.5,21.38 22.5,16.5 21.95,11C21.5,6.25 17.73,2.5 13,2.03M11,2.06C9.05,2.25 7.19,3 5.67,4.26L7.1,5.74C8.22,4.84 9.57,4.26 11,4.06V2.06M4.26,5.67C3,7.19 2.25,9.04 2.05,11H4.05C4.24,9.58 4.8,8.23 5.69,7.1L4.26,5.67M2.06,13C2.26,14.96 3.03,16.81 4.27,18.33L5.69,16.9C4.81,15.77 4.24,14.42 4.06,13H2.06M7.1,18.37L5.67,19.74C7.18,21 9.04,21.79 11,22V20C9.58,19.82 8.23,19.25 7.1,18.37M16.82,15.19L12.71,11.08C13.12,10.04 12.89,8.82 12.03,7.97C11.13,7.06 9.78,6.88 8.69,7.38L10.63,9.32L9.38,10.57L7.38,8.57C6.88,9.67 7.05,11.02 7.97,11.94C8.83,12.79 10.05,13.02 11.08,12.6L15.19,16.7C15.29,16.8 15.45,16.86 15.61,16.86C15.77,16.86 15.93,16.8 16.03,16.7L16.82,15.9C17.02,15.71 17.02,15.4 16.82,15.19Z" />
                                </svg>
                            </div>
                        </div>
                    </div>
                    <div class="col col-3">
                        <div class="stat-card" style="background: linear-gradient(45deg, #ED213A, #93291E);">
                            <div class="stat-title">异常记录</div>
                            <div class="stat-value">8</div>
                            <div class="stat-description">需要处理</div>
                            <div class="stat-icon">
                                <svg viewBox="0 0 24 24" width="80" height="80" fill="currentColor">
                                    <path d="M11,15H13V17H11V15M11,7H13V13H11V7M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20Z" />
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 功能区域 -->
                <div class="row">
                    <div class="col col-12">
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">学历信息管理</h2>
                                <div class="card-tools">
                                    <button class="btn btn-primary">
                                        <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" style="margin-right: 5px; vertical-align: text-top;">
                                            <path d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z" />
                                        </svg>
                                        添加学生
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <!-- 选项卡导航 -->
                                <div class="tabs">
                                    <div class="tab active" data-tab="all">全部学生</div>
                                    <div class="tab" data-tab="pending">待审核</div>
                                    <div class="tab" data-tab="verified">已上链</div>
                                    <div class="tab" data-tab="rejected">拒绝记录</div>
                                    <div class="tab" data-tab="exception">异常情况</div>
                                </div>
                                
                                <!-- 批量上传区域 -->
                                <div class="row">
                                    <div class="col col-6">
                                        <div class="upload-zone" id="dropZone">
                                            <svg class="upload-icon" viewBox="0 0 24 24" fill="currentColor">
                                                <path d="M14,13V17H10V13H7L12,8L17,13M19.35,10.03C18.67,6.59 15.64,4 12,4C9.11,4 6.6,5.64 5.35,8.03C2.34,8.36 0,10.9 0,14A6,6 0 0,0 6,20H19A5,5 0 0,0 24,15C24,12.36 21.95,10.22 19.35,10.03Z" />
                                            </svg>
                                            <p class="upload-text">拖拽CSV文件到此处或点击上传</p>
                                            <p class="upload-hint">支持 .csv 格式，单次最多导入1000条记录</p>
                                            <div style="display: flex; gap: 10px; justify-content: center;">
                                                <button class="btn btn-primary" id="fileSelectBtn">选择文件</button>
                                                <button class="btn btn-outline" id="downloadTemplateBtn">下载模板</button>
                                            </div>
                                            <input type="file" id="fileInput" accept=".csv" style="display: none;">
                                        </div>
                                        <!-- 上传进度条 -->
                                        <div id="uploadProgress" style="display: none; margin-top: 15px;">
                                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                                <span>上传进度</span>
                                                <span id="progressText">0%</span>
                                            </div>
                                            <div class="progress-bar">
                                                <div id="progressFill" class="progress-fill"></div>
                                            </div>
                                        </div>
                                        <!-- 文件预览 -->
                                        <div id="filePreview" style="display: none; margin-top: 15px;">
                                            <h4>文件预览</h4>
                                            <div id="previewTable" class="table-container" style="max-height: 200px; overflow: auto;">
                                                <!-- 预览表格将在这里生成 -->
                                            </div>
                                            <div style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                                                <span id="fileInfo"></span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col col-6">
                                        <div class="card">
                                            <div class="card-header">
                                                <h3 class="card-title">批量操作</h3>
                                            </div>
                                            <div class="card-body">
                                                <div class="form-group">
                                                    <label class="form-label">选择操作类型</label>
                                                    <select class="form-select" id="operationType">
                                                        <option value="">请选择操作类型</option>
                                                        <option value="upload">批量上链</option>
                                                        <option value="verify">批量审核</option>
                                                        <option value="export">导出数据</option>
                                                        <option value="notify">批量通知</option>
                                                    </select>
                                                </div>
                                                <div class="form-group">
                                                    <label class="form-label">操作说明</label>
                                                    <textarea class="form-control" rows="3" placeholder="请输入本次操作的说明信息（选填）" id="operationDescription"></textarea>
                                                </div>
                                                <div class="form-group">
                                                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border: 1px solid #e9ecef;">
                                                        <h5 style="margin: 0 0 10px 0; font-size: 1rem;">数据验证结果</h5>
                                                        <div id="validationResults">
                                                            <p style="margin: 0; color: #666;">请先上传CSV文件进行数据验证</p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                                    <button class="btn btn-outline" id="validateDataBtn" style="display: none;">
                                                        <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" style="margin-right: 5px; vertical-align: text-top;">
                                                            <path d="M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1Z" />
                                                        </svg>
                                                        验证数据
                                                    </button>
                                                    <button class="btn btn-primary" id="executeOperationBtn" disabled>执行操作</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- 筛选和搜索区域 -->
                                <div class="filter-section">
                                    <div class="search-box">
                                        <svg class="search-icon" viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                                            <path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" />
                                        </svg>
                                        <input type="text" class="search-input" placeholder="搜索学生姓名、学号或专业">
                                    </div>
                                    <select class="filter-dropdown">
                                        <option value="">所有学院</option>
                                        <option value="computer">计算机学院</option>
                                        <option value="management">管理学院</option>
                                        <option value="science">理学院</option>
                                        <option value="humanities">人文学院</option>
                                    </select>
                                    <select class="filter-dropdown">
                                        <option value="">所有年级</option>
                                        <option value="2024">2024级</option>
                                        <option value="2022">2022级</option>
                                        <option value="2021">2021级</option>
                                        <option value="2020">2020级</option>
                                    </select>
                                    <select class="filter-dropdown">
                                        <option value="">所有状态</option>
                                        <option value="verified">已上链</option>
                                        <option value="pending">待审核</option>
                                        <option value="rejected">已拒绝</option>
                                        <option value="exception">异常</option>
                                    </select>
                                    <button class="btn btn-outline">
                                        <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" style="margin-right: 5px; vertical-align: text-top;">
                                            <path d="M14,12V19.88C14.04,20.18 13.94,20.5 13.71,20.71C13.32,21.1 12.69,21.1 12.3,20.71L10.29,18.7C10.06,18.47 9.96,18.16 10,17.87V12H9.97L4.21,4.62C3.87,4.19 3.95,3.56 4.38,3.22C4.57,3.08 4.78,3 5,3H19C19.22,3 19.43,3.08 19.62,3.22C20.05,3.56 20.13,4.19 19.79,4.62L14.03,12H14Z" />
                                        </svg>
                                        筛选
                                    </button>
                                </div>
                                
                                <!-- 数据表格区域 -->
                                <div class="table-container">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th width="40">
                                                    <div class="checkbox-container">
                                                        <input type="checkbox" id="select-all" class="checkbox-input">
                                                        <label for="select-all" class="checkbox-label"></label>
                                                    </div>
                                                </th>
                                                <th>学号</th>
                                                <th>姓名</th>
                                                <th>学院</th>
                                                <th>专业</th>
                                                <th>学历</th>
                                                <th>入学年份</th>
                                                <th>毕业年份</th>
                                                <th>状态</th>
                                                <th>上链时间</th>
                                                <th>操作</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>
                                                    <div class="checkbox-container">
                                                        <input type="checkbox" id="select-1" class="checkbox-input">
                                                        <label for="select-1" class="checkbox-label"></label>
                                                    </div>
                                                </td>
                                                <td>2020010001</td>
                                                <td>张三</td>
                                                <td>计算机学院</td>
                                                <td>计算机科学与技术</td>
                                                <td>本科</td>
                                                <td>2020</td>
                                                <td>2024</td>
                                                <td><span class="badge badge-success">已上链</span></td>
                                                <td>2024-05-20 14:30</td>
                                                <td>
                                                    <button class="action-btn view" title="查看详情" data-student-id="2020010001" data-student-name="张三">
                                                        <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                                                            <path d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z" />
                                                        </svg>
                                                    </button>
                                                    <button class="action-btn edit" title="编辑信息" data-student-id="2020010001" data-student-name="张三">
                                                        <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                                                            <path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" />
                                                        </svg>
                                                    </button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="checkbox-container">
                                                        <input type="checkbox" id="select-2" class="checkbox-input">
                                                        <label for="select-2" class="checkbox-label"></label>
                                                    </div>
                                                </td>
                                                <td>2020010002</td>
                                                <td>李四</td>
                                                <td>计算机学院</td>
                                                <td>软件工程</td>
                                                <td>本科</td>
                                                <td>2020</td>
                                                <td>2024</td>
                                                <td><span class="badge badge-warning">待审核</span></td>
                                                <td>-</td>
                                                <td>
                                                    <button class="action-btn view" title="查看详情" data-student-id="2020010002">
                                                        <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                                                            <path d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z" />
                                                        </svg>
                                                    </button>
                                                    <button class="action-btn approve" title="审核通过" data-student-id="2020010002" data-student-name="李四">
                                                        <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                                                            <path d="M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1Z" />
                                                        </svg>
                                                    </button>
                                                    <button class="action-btn reject" title="审核拒绝" data-student-id="2020010002" data-student-name="李四">
                                                        <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                                                            <path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" />
                                                        </svg>
                                                    </button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="checkbox-container">
                                                        <input type="checkbox" id="select-3" class="checkbox-input">
                                                        <label for="select-3" class="checkbox-label"></label>
                                                    </div>
                                                </td>
                                                <td>2021010003</td>
                                                <td>王五</td>
                                                <td>管理学院</td>
                                                <td>工商管理</td>
                                                <td>本科</td>
                                                <td>2021</td>
                                                <td>2025</td>
                                                <td><span class="badge badge-success">已上链</span></td>
                                                <td>2024-05-15 09:45</td>
                                                <td>
                                                    <button class="action-btn view" title="查看详情">
                                                        <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                                                            <path d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z" />
                                                        </svg>
                                                    </button>
                                                    <button class="action-btn edit" title="编辑信息">
                                                        <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                                                            <path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" />
                                                        </svg>
                                                    </button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="checkbox-container">
                                                        <input type="checkbox" id="select-4" class="checkbox-input">
                                                        <label for="select-4" class="checkbox-label"></label>
                                                    </div>
                                                </td>
                                                <td>2020010004</td>
                                                <td>赵六</td>
                                                <td>理学院</td>
                                                <td>数学与应用数学</td>
                                                <td>本科</td>
                                                <td>2020</td>
                                                <td>2024</td>
                                                <td><span class="badge badge-danger">异常</span></td>
                                                <td>-</td>
                                                <td>
                                                    <button class="action-btn view" title="查看详情">
                                                        <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                                                            <path d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z" />
                                                        </svg>
                                                    </button>
                                                    <button class="action-btn edit" title="编辑信息">
                                                        <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                                                            <path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" />
                                                        </svg>
                                                    </button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="checkbox-container">
                                                        <input type="checkbox" id="select-5" class="checkbox-input">
                                                        <label for="select-5" class="checkbox-label"></label>
                                                    </div>
                                                </td>
                                                <td>2022010005</td>
                                                <td>孙七</td>
                                                <td>人文学院</td>
                                                <td>汉语言文学</td>
                                                <td>本科</td>
                                                <td>2022</td>
                                                <td>2026</td>
                                                <td><span class="badge badge-primary">待上链</span></td>
                                                <td>-</td>
                                                <td>
                                                    <button class="action-btn view" title="查看详情">
                                                        <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                                                            <path d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z" />
                                                        </svg>
                                                    </button>
                                                    <button class="action-btn edit" title="编辑信息">
                                                        <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                                                            <path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" />
                                                        </svg>
                                                    </button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                
                                <!-- 分页区域 -->
                                <div class="pagination">
                                    <div class="pagination-item disabled">
                                        <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
                                            <path d="M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z" />
                                        </svg>
                                    </div>
                                    <div class="pagination-item active">1</div>
                                    <div class="pagination-item">2</div>
                                    <div class="pagination-item">3</div>
                                    <div class="pagination-item">4</div>
                                    <div class="pagination-item">5</div>
                                    <div class="pagination-item">
                                        <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
                                            <path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" />
                                        </svg>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div> <!-- 结束 default-content -->
    
    <!-- 详情查看弹窗 -->
    <div class="modal" id="studentDetailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">学生详情</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">学号</label>
                            <p>2020010001</p>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">姓名</label>
                            <p>张三</p>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">性别</label>
                            <p>男</p>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">身份证号</label>
                            <p>1**************1</p>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">学院</label>
                            <p>计算机学院</p>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">专业</label>
                            <p>计算机科学与技术</p>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">学历</label>
                            <p>本科</p>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">学制</label>
                            <p>4年</p>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">入学年份</label>
                            <p>2020年</p>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">毕业年份</label>
                            <p>2024年</p>
                        </div>
                    </div>
                    <div class="col col-12">
                        <div class="form-group">
                            <label class="form-label">区块链信息</label>
                            <div style="background: rgba(0,0,0,0.03); padding: 10px; border-radius: 5px; font-family: monospace; overflow-x: auto;">
                                <p>交易哈希: 0x7d6a5743a5ef92d8e44f5a8d17d31cb94c7ede087c10e2f498dfccfe8de4babd</p>
                                <p>区块高度: 1,246,783</p>
                                <p>确认时间: 2024-05-20 14:30:22</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 20px;">
                    <h3 style="font-size: 1.1rem; margin-bottom: 15px;">操作历史</h3>
                    <div class="table-container" style="max-height: 200px; overflow-y: auto;">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>操作类型</th>
                                    <th>操作人</th>
                                    <th>时间</th>
                                    <th>说明</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>信息录入</td>
                                    <td>admin</td>
                                    <td>2024-09-01 10:15</td>
                                    <td>初始信息录入</td>
                                </tr>
                                <tr>
                                    <td>信息修改</td>
                                    <td>王老师</td>
                                    <td>2024-04-15 09:30</td>
                                    <td>更新专业信息</td>
                                </tr>
                                <tr>
                                    <td>上链操作</td>
                                    <td>李主任</td>
                                    <td>2024-05-20 14:30</td>
                                    <td>学历信息上链</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline modal-close-btn">关闭</button>
                <button class="btn btn-primary">下载证书</button>
            </div>
        </div>
    </div>
    
    <!-- 编辑信息弹窗 -->
    <div class="modal" id="editStudentModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">编辑学生信息</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">学号</label>
                            <input type="text" class="form-control" value="2020010001" readonly>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">姓名</label>
                            <input type="text" class="form-control" value="张三">
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">性别</label>
                            <select class="form-select">
                                <option value="male" selected>男</option>
                                <option value="female">女</option>
                            </select>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">身份证号</label>
                            <input type="text" class="form-control" value="1**************1">
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">学院</label>
                            <select class="form-select">
                                <option value="computer" selected>计算机学院</option>
                                <option value="management">管理学院</option>
                                <option value="science">理学院</option>
                                <option value="humanities">人文学院</option>
                            </select>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">专业</label>
                            <select class="form-select">
                                <option value="cs" selected>计算机科学与技术</option>
                                <option value="se">软件工程</option>
                                <option value="ai">人工智能</option>
                                <option value="is">信息安全</option>
                            </select>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">学历</label>
                            <select class="form-select">
                                <option value="bachelor" selected>本科</option>
                                <option value="master">硕士</option>
                                <option value="doctor">博士</option>
                            </select>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">学制</label>
                            <select class="form-select">
                                <option value="4" selected>4年</option>
                                <option value="3">3年</option>
                                <option value="2">2年</option>
                            </select>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">入学年份</label>
                            <input type="number" class="form-control" value="2020">
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">毕业年份</label>
                            <input type="number" class="form-control" value="2024">
                        </div>
                    </div>
                    <div class="col col-12">
                        <div class="form-group">
                            <label class="form-label">备注</label>
                            <textarea class="form-control" rows="3"></textarea>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline modal-close-btn">取消</button>
                <button class="btn btn-primary">保存更改</button>
            </div>
        </div>
    </div>
    
    <!-- 批量上链确认弹窗 -->
    <div class="modal" id="bulkActionModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">批量上链确认</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <p>您选择了 <strong>32</strong> 名学生的信息进行批量上链操作。请确认以下信息：</p>
                </div>
                <div class="form-group">
                    <label class="form-label">操作类型</label>
                    <p>批量上链操作 - 将所选学生信息上传至区块链</p>
                </div>
                <div class="form-group">
                    <label class="form-label">审核人</label>
                    <p>当前登录账号: 学链通大学 - 高校管理员</p>
                </div>
                <div class="form-group">
                    <label class="form-label">操作说明</label>
                    <textarea class="form-control" rows="3" placeholder="请输入本次操作的说明信息（选填）"></textarea>
                </div>
                <div class="form-group">
                    <div class="checkbox-container">
                        <input type="checkbox" id="confirm-check" class="checkbox-input">
                        <label for="confirm-check" class="checkbox-label">我确认已检查所选学生信息，数据准确无误</label>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline modal-close-btn">取消</button>
                <button class="btn btn-primary">确认上链</button>
            </div>
        </div>
    </div>
    
    <!-- 审核通过确认弹窗 -->
    <div class="modal" id="approveModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">审核通过确认</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <p>您确定要通过 <strong id="approve-student-name">学生姓名</strong> 的学历信息审核吗？</p>
                </div>
                <div class="form-group">
                    <label class="form-label">学号</label>
                    <p id="approve-student-id">学号信息</p>
                </div>
                <div class="form-group">
                    <label class="form-label">审核意见</label>
                    <textarea class="form-control" rows="3" placeholder="请输入审核意见（选填）" id="approve-comment"></textarea>
                </div>
                <div class="form-group">
                    <div class="checkbox-container">
                        <input type="checkbox" id="approve-confirm-check" class="checkbox-input">
                        <label for="approve-confirm-check" class="checkbox-label">我确认已检查学生信息，数据准确无误</label>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline modal-close-btn">取消</button>
                <button class="btn btn-primary" id="confirm-approve-btn">确认通过</button>
            </div>
        </div>
    </div>
    
    <!-- 审核拒绝确认弹窗 -->
    <div class="modal" id="rejectModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">审核拒绝确认</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <p>您确定要拒绝 <strong id="reject-student-name">学生姓名</strong> 的学历信息审核吗？</p>
                </div>
                <div class="form-group">
                    <label class="form-label">学号</label>
                    <p id="reject-student-id">学号信息</p>
                </div>
                <div class="form-group">
                    <label class="form-label">拒绝原因 <span style="color: red;">*</span></label>
                    <select class="form-select" id="reject-reason">
                        <option value="">请选择拒绝原因</option>
                        <option value="信息不完整">信息不完整</option>
                        <option value="信息有误">信息有误</option>
                        <option value="证明材料不足">证明材料不足</option>
                        <option value="其他">其他</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">详细说明</label>
                    <textarea class="form-control" rows="3" placeholder="请详细说明拒绝原因" id="reject-comment" required></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline modal-close-btn">取消</button>
                <button class="btn btn-danger" id="confirm-reject-btn">确认拒绝</button>
            </div>
        </div>
    </div>
    
    <!-- 学生详情查看弹窗 -->
    <div class="modal" id="studentDetailViewModal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2 class="modal-title">学生详细信息</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">学号</label>
                            <p id="detail-student-id">-</p>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">姓名</label>
                            <p id="detail-student-name">-</p>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">性别</label>
                            <p id="detail-student-gender">-</p>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">身份证号</label>
                            <p id="detail-student-idcard">-</p>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">学院</label>
                            <p id="detail-student-college">-</p>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">专业</label>
                            <p id="detail-student-major">-</p>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">学历</label>
                            <p id="detail-student-degree">-</p>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">学制</label>
                            <p id="detail-student-duration">-</p>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">入学年份</label>
                            <p id="detail-student-admission">-</p>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="form-group">
                            <label class="form-label">毕业年份</label>
                            <p id="detail-student-graduation">-</p>
                        </div>
                    </div>
                    <div class="col col-12">
                        <div class="form-group">
                            <label class="form-label">区块链信息</label>
                            <div id="detail-blockchain-info" style="background: rgba(0,0,0,0.03); padding: 15px; border-radius: 8px; font-family: monospace;">
                                <p style="margin: 5px 0;"><strong>交易哈希:</strong> <span id="detail-tx-hash">-</span></p>
                                <p style="margin: 5px 0;"><strong>区块高度:</strong> <span id="detail-block-height">-</span></p>
                                <p style="margin: 5px 0;"><strong>上链时间:</strong> <span id="detail-blockchain-time">-</span></p>
                                <p style="margin: 5px 0;"><strong>状态:</strong> <span id="detail-status" class="badge">-</span></p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 20px;">
                    <h3 style="font-size: 1.1rem; margin-bottom: 15px;">审核历史</h3>
                    <div class="table-container" style="max-height: 200px; overflow-y: auto;">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>操作类型</th>
                                    <th>操作人</th>
                                    <th>时间</th>
                                    <th>说明</th>
                                </tr>
                            </thead>
                            <tbody id="detail-audit-history">
                                <!-- 审核历史数据将在这里填充 -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline modal-close-btn">关闭</button>
                <button class="btn btn-primary" id="download-certificate-btn">下载证书</button>
            </div>
        </div>
    </div>
    
    <!-- JavaScript 增强功能 -->
    <script src="../scripts/school_management.js"></script>
    
    <!-- 批量上传功能 -->
    <script>
    // 批量上传管理器
    class BulkUploadManager {
        constructor() {
            this.csvData = null;
            this.validatedData = null;
            this.currentFile = null;
            this.init();
        }
        
        init() {
            this.bindEvents();
            this.setupDragAndDrop();
        }
        
        bindEvents() {
            const fileInput = document.getElementById('fileInput');
            const fileSelectBtn = document.getElementById('fileSelectBtn');
            const downloadTemplateBtn = document.getElementById('downloadTemplateBtn');
            const validateBtn = document.getElementById('validateDataBtn');
            const executeBtn = document.getElementById('executeOperationBtn');
            
            fileSelectBtn.addEventListener('click', () => {
                fileInput.click();
            });
            
            downloadTemplateBtn.addEventListener('click', () => {
                this.downloadTemplate();
            });
            
            fileInput.addEventListener('change', (e) => {
                this.handleFileSelect(e.target.files[0]);
            });
            
            validateBtn.addEventListener('click', () => {
                this.validateData();
            });
            
            executeBtn.addEventListener('click', () => {
                this.executeOperation();
            });
        }
        
        setupDragAndDrop() {
            const dropZone = document.getElementById('dropZone');
            
            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('dragover');
            });
            
            dropZone.addEventListener('dragleave', (e) => {
                e.preventDefault();
                dropZone.classList.remove('dragover');
            });
            
            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('dragover');
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    this.handleFileSelect(files[0]);
                }
            });
        }
        
        handleFileSelect(file) {
            if (!file) return;
            
            // 验证文件类型
            if (!file.name.toLowerCase().endsWith('.csv')) {
                this.showNotification('请选择CSV文件', 'error');
                return;
            }
            
            // 验证文件大小 (5MB限制)
            if (file.size > 5 * 1024 * 1024) {
                this.showNotification('文件大小不能超过5MB', 'error');
                return;
            }
            
            this.currentFile = file;
            this.readCSVFile(file);
        }
        
        readCSVFile(file) {
            const reader = new FileReader();
            
            reader.onload = (e) => {
                try {
                    const csv = e.target.result;
                    this.csvData = this.parseCSV(csv);
                    this.showFilePreview();
                    this.showValidateButton();
                } catch (error) {
                    this.showNotification('CSV文件解析失败: ' + error.message, 'error');
                }
            };
            
            reader.onerror = () => {
                this.showNotification('文件读取失败', 'error');
            };
            
            reader.readAsText(file, 'UTF-8');
        }
        
        parseCSV(csv) {
            const lines = csv.trim().split('\n');
            if (lines.length < 2) {
                throw new Error('CSV文件至少需要包含标题行和一行数据');
            }
            
            const headers = this.parseCSVLine(lines[0]);
            const data = [];
            
            for (let i = 1; i < lines.length; i++) {
                if (lines[i].trim()) {
                    const row = this.parseCSVLine(lines[i]);
                    const rowData = {};
                    
                    headers.forEach((header, index) => {
                        rowData[header] = row[index] || '';
                    });
                    
                    data.push(rowData);
                }
            }
            
            return {
                headers: headers,
                data: data,
                totalRows: data.length
            };
        }
        
        parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                
                if (char === '"') {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    result.push(current.trim());
                    current = '';
                } else {
                    current += char;
                }
            }
            
            result.push(current.trim());
            return result;
        }
        
        showFilePreview() {
            const preview = document.getElementById('filePreview');
            const previewTable = document.getElementById('previewTable');
            const fileInfo = document.getElementById('fileInfo');
            
            // 显示文件信息
            fileInfo.textContent = `文件: ${this.currentFile.name} | 大小: ${this.formatFileSize(this.currentFile.size)} | 记录数: ${this.csvData.totalRows}`;
            
            // 生成预览表格
            let tableHTML = '<table class="table"><thead><tr>';
            this.csvData.headers.forEach(header => {
                tableHTML += `<th>${this.escapeHtml(header)}</th>`;
            });
            tableHTML += '</tr></thead><tbody>';
            
            // 只显示前5行数据作为预览
            const previewRows = this.csvData.data.slice(0, 5);
            previewRows.forEach(row => {
                tableHTML += '<tr>';
                this.csvData.headers.forEach(header => {
                    tableHTML += `<td title="${this.escapeHtml(row[header])}">${this.escapeHtml(row[header])}</td>`;
                });
                tableHTML += '</tr>';
            });
            
            if (this.csvData.totalRows > 5) {
                tableHTML += `<tr><td colspan="${this.csvData.headers.length}" style="text-align: center; color: #666; font-style: italic;">... 还有 ${this.csvData.totalRows - 5} 行数据</td></tr>`;
            }
            
            tableHTML += '</tbody></table>';
            previewTable.innerHTML = tableHTML;
            preview.style.display = 'block';
        }
        
        showValidateButton() {
            document.getElementById('validateDataBtn').style.display = 'inline-block';
        }
        
        validateData() {
            if (!this.csvData) {
                this.showNotification('请先上传CSV文件', 'error');
                return;
            }
            
            const requiredFields = ['学号', '姓名', '学院', '专业', '学历', '入学年份', '毕业年份'];
            const results = document.getElementById('validationResults');
            let validationHTML = '';
            let isValid = true;
            let validCount = 0;
            let errorCount = 0;
            let warningCount = 0;
            
            // 检查必需字段
            const missingFields = requiredFields.filter(field => !this.csvData.headers.includes(field));
            if (missingFields.length > 0) {
                validationHTML += this.createValidationItem('error', `缺少必需字段: ${missingFields.join(', ')}`);
                isValid = false;
                errorCount++;
            }
            
            // 验证数据记录
            const duplicateStudentIds = new Set();
            const studentIds = new Set();
            
            this.csvData.data.forEach((row, index) => {
                const rowErrors = [];
                
                // 验证学号
                if (!row['学号'] || row['学号'].trim() === '') {
                    rowErrors.push('学号不能为空');
                } else if (studentIds.has(row['学号'])) {
                    duplicateStudentIds.add(row['学号']);
                } else {
                    studentIds.add(row['学号']);
                }
                
                // 验证姓名
                if (!row['姓名'] || row['姓名'].trim() === '') {
                    rowErrors.push('姓名不能为空');
                }
                
                // 验证入学年份
                const admissionYear = parseInt(row['入学年份']);
                if (isNaN(admissionYear) || admissionYear < 1900 || admissionYear > new Date().getFullYear()) {
                    rowErrors.push('入学年份格式错误');
                }
                
                // 验证毕业年份
                const graduationYear = parseInt(row['毕业年份']);
                if (!isNaN(graduationYear) && graduationYear > new Date().getFullYear() + 10) {
                    rowErrors.push('毕业年份可能有误');
                }
                
                if (rowErrors.length > 0) {
                    validationHTML += this.createValidationItem('error', `第${index + 2}行: ${rowErrors.join(', ')}`);
                    errorCount++;
                    isValid = false;
                }
            });
            
            // 检查重复学号
            if (duplicateStudentIds.size > 0) {
                validationHTML += this.createValidationItem('error', `发现重复学号: ${Array.from(duplicateStudentIds).join(', ')}`);
                errorCount++;
                isValid = false;
            }
            
            // 显示统计信息
            if (isValid) {
                validCount = this.csvData.totalRows;
                validationHTML = this.createValidationItem('success', `验证通过！共 ${validCount} 条记录可以导入`) + validationHTML;
                document.getElementById('executeOperationBtn').disabled = false;
                this.validatedData = this.csvData.data;
            } else {
                validationHTML = this.createValidationItem('error', `验证失败！发现 ${errorCount} 个错误，请修正后重新上传`) + validationHTML;
                document.getElementById('executeOperationBtn').disabled = true;
            }
            
            results.innerHTML = validationHTML;
        }
        
        createValidationItem(type, message) {
            const icons = {
                success: '<svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1Z" /></svg>',
                error: '<svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z" /></svg>',
                warning: '<svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M13,14H11V10H13M13,18H11V16H13M1,21H23L12,2L1,21Z" /></svg>'
            };
            
            return `<div class="validation-item validation-${type}">${icons[type]} ${this.escapeHtml(message)}</div>`;
        }
        
        executeOperation() {
            const operationType = document.getElementById('operationType').value;
            const description = document.getElementById('operationDescription').value;
            
            if (!operationType) {
                this.showNotification('请选择操作类型', 'error');
                return;
            }
            
            if (!this.validatedData) {
                this.showNotification('请先验证数据', 'error');
                return;
            }
            
            this.showProgress();
            
            // 模拟批量操作
            this.simulateBulkOperation(operationType, description);
        }
        
        simulateBulkOperation(operationType, description) {
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            let progress = 0;
            
            const interval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress > 100) progress = 100;
                
                progressFill.style.width = progress + '%';
                progressText.textContent = Math.round(progress) + '%';
                
                if (progress >= 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        this.handleOperationComplete(operationType);
                    }, 500);
                }
            }, 200);
        }
        
        handleOperationComplete(operationType) {
            this.hideProgress();
            
            const operationNames = {
                upload: '批量上链',
                verify: '批量审核',
                export: '导出数据',
                notify: '批量通知'
            };
            
            const message = `${operationNames[operationType]}操作完成！处理了 ${this.validatedData.length} 条记录`;
            this.showNotification(message, 'success');
            
            // 重置表单
            this.resetForm();
            
            // 更新统计数据（模拟）
            this.updateStatistics(operationType);
        }
        
        showProgress() {
            document.getElementById('uploadProgress').style.display = 'block';
            document.getElementById('executeOperationBtn').disabled = true;
        }
        
        hideProgress() {
            document.getElementById('uploadProgress').style.display = 'none';
            document.getElementById('executeOperationBtn').disabled = false;
        }
        
        resetForm() {
            document.getElementById('fileInput').value = '';
            document.getElementById('filePreview').style.display = 'none';
            document.getElementById('validateDataBtn').style.display = 'none';
            document.getElementById('operationType').value = '';
            document.getElementById('operationDescription').value = '';
            document.getElementById('validationResults').innerHTML = '<p style="margin: 0; color: #666;">请先上传CSV文件进行数据验证</p>';
            document.getElementById('executeOperationBtn').disabled = true;
            
            this.csvData = null;
            this.validatedData = null;
            this.currentFile = null;
        }
        
        updateStatistics(operationType) {
            // 这里可以更新页面上的统计数字
            if (operationType === 'upload') {
                const uploadedCount = document.querySelector('.stat-card:nth-child(2) .stat-value');
                if (uploadedCount) {
                    const current = parseInt(uploadedCount.textContent.replace(/,/g, ''));
                    const newCount = current + this.validatedData.length;
                    uploadedCount.textContent = newCount.toLocaleString();
                }
            }
        }
        
        formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        downloadTemplate() {
            const templateData = [
                ['学号', '姓名', '性别', '身份证号', '学院', '专业', '学历', '学制', '入学年份', '毕业年份', '备注'],
                ['2020010001', '张三', '男', '110101199001011234', '计算机学院', '计算机科学与技术', '本科', '4', '2020', '2024', ''],
                ['2020010002', '李四', '女', '110101199001021234', '计算机学院', '软件工程', '本科', '4', '2020', '2024', ''],
                ['2021010001', '王五', '男', '110101199101011234', '管理学院', '工商管理', '本科', '4', '2021', '2025', ''],
                ['2022010001', '赵六', '女', '110101199201011234', '理学院', '数学与应用数学', '本科', '4', '2022', '2026', '']
            ];
            
            // 转换为CSV格式
            const csvContent = templateData.map(row => 
                row.map(field => {
                    // 如果字段包含逗号、双引号或换行符，需要用双引号包围
                    if (field.includes(',') || field.includes('"') || field.includes('\n')) {
                        return '"' + field.replace(/"/g, '""') + '"';
                    }
                    return field;
                }).join(',')
            ).join('\n');
            
            // 创建下载链接
            const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = '学生信息导入模板.csv';
            link.style.display = 'none';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            URL.revokeObjectURL(link.href);
            
            this.showNotification('CSV模板已下载，请按照模板格式填写数据', 'success');
        }
        
        showNotification(message, type = 'info') {
            // 创建通知元素
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // 3秒后自动移除
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 3000);
        }
    }
    
    // 初始化批量上传管理器
    document.addEventListener('DOMContentLoaded', function() {
        new BulkUploadManager();
        new AuditManager();
    });
    </script>
    
    <!-- 审核管理功能 -->
    <script>
    // 审核管理器
    class AuditManager {
        constructor() {
            this.currentStudentData = null;
            this.init();
        }
        
        init() {
            this.bindEvents();
        }
        
        bindEvents() {
            // 绑定审核按钮事件
            document.addEventListener('click', (e) => {
                if (e.target.closest('.action-btn.approve')) {
                    this.handleApprove(e.target.closest('.action-btn.approve'));
                } else if (e.target.closest('.action-btn.reject')) {
                    this.handleReject(e.target.closest('.action-btn.reject'));
                } else if (e.target.closest('.action-btn.view')) {
                    this.handleViewDetail(e.target.closest('.action-btn.view'));
                } else if (e.target.closest('.modal-close') || e.target.closest('.modal-close-btn')) {
                    // 处理模态框关闭按钮
                    const modal = e.target.closest('.modal');
                    if (modal) {
                        this.hideModal(modal.id);
                    }
                }
            });
            
            // 绑定模态框确认按钮事件
            document.getElementById('confirm-approve-btn').addEventListener('click', () => {
                this.confirmApprove();
            });
            
            document.getElementById('confirm-reject-btn').addEventListener('click', () => {
                this.confirmReject();
            });
            
            // 绑定下载证书按钮事件
            document.getElementById('download-certificate-btn').addEventListener('click', () => {
                this.downloadCertificate();
            });
            
            // 绑定模态框背景点击关闭事件
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('modal')) {
                    this.hideModal(e.target.id);
                }
            });
        }
        
        handleApprove(button) {
            const studentId = button.getAttribute('data-student-id');
            const studentName = button.getAttribute('data-student-name');
            
            // 填充审核通过模态框信息
            document.getElementById('approve-student-name').textContent = studentName;
            document.getElementById('approve-student-id').textContent = studentId;
            document.getElementById('approve-comment').value = '';
            document.getElementById('approve-confirm-check').checked = false;
            
            // 存储当前学生数据
            this.currentStudentData = { studentId, studentName, action: 'approve' };
            
            // 显示模态框
            this.showModal('approveModal');
        }
        
        handleReject(button) {
            const studentId = button.getAttribute('data-student-id');
            const studentName = button.getAttribute('data-student-name');
            
            // 填充审核拒绝模态框信息
            document.getElementById('reject-student-name').textContent = studentName;
            document.getElementById('reject-student-id').textContent = studentId;
            document.getElementById('reject-reason').value = '';
            document.getElementById('reject-comment').value = '';
            
            // 存储当前学生数据
            this.currentStudentData = { studentId, studentName, action: 'reject' };
            
            // 显示模态框
            this.showModal('rejectModal');
        }
        
        handleViewDetail(button) {
            const studentId = button.getAttribute('data-student-id');
            const studentName = button.getAttribute('data-student-name');
            
            // 模拟获取学生详细信息
            const studentData = this.getStudentDetailData(studentId, studentName);
            
            // 填充详情模态框
            this.fillDetailModal(studentData);
            
            // 显示模态框
            this.showModal('studentDetailViewModal');
        }
        
        confirmApprove() {
            const confirmCheck = document.getElementById('approve-confirm-check');
            const comment = document.getElementById('approve-comment').value;
            
            if (!confirmCheck.checked) {
                this.showNotification('请确认已检查学生信息', 'error');
                return;
            }
            
            // 执行审核通过操作
            this.executeApprove(this.currentStudentData.studentId, comment);
        }
        
        confirmReject() {
            const reason = document.getElementById('reject-reason').value;
            const comment = document.getElementById('reject-comment').value;
            
            if (!reason) {
                this.showNotification('请选择拒绝原因', 'error');
                return;
            }
            
            if (!comment.trim()) {
                this.showNotification('请填写详细说明', 'error');
                return;
            }
            
            // 执行审核拒绝操作
            this.executeReject(this.currentStudentData.studentId, reason, comment);
        }
        
        executeApprove(studentId, comment) {
            // 模拟API调用
            setTimeout(() => {
                // 更新页面状态
                this.updateStudentStatus(studentId, 'approved');
                
                // 显示成功通知
                this.showNotification(`学生 ${this.currentStudentData.studentName} 审核通过成功！`, 'success');
                
                // 关闭模态框
                this.hideModal('approveModal');
                
                // 更新统计数据
                this.updateStatistics('approve');
                
                // 记录审核历史
                this.recordAuditHistory(studentId, '审核通过', comment);
                
            }, 1000);
        }
        
        executeReject(studentId, reason, comment) {
            // 模拟API调用
            setTimeout(() => {
                // 更新页面状态
                this.updateStudentStatus(studentId, 'rejected');
                
                // 显示成功通知
                this.showNotification(`学生 ${this.currentStudentData.studentName} 审核拒绝成功！`, 'success');
                
                // 关闭模态框
                this.hideModal('rejectModal');
                
                // 更新统计数据
                this.updateStatistics('reject');
                
                // 记录审核历史
                this.recordAuditHistory(studentId, '审核拒绝', `${reason}: ${comment}`);
                
            }, 1000);
        }
        
        updateStudentStatus(studentId, status) {
            // 更新表格中的行状态
            const rows = document.querySelectorAll('tbody tr');
            rows.forEach(row => {
                const idCell = row.children[1]; // 学号列
                if (idCell && idCell.textContent === studentId) {
                    const statusCell = row.children[8]; // 状态列
                    const actionCell = row.children[10]; // 操作列
                    
                    if (status === 'approved') {
                        statusCell.innerHTML = '<span class="badge badge-success">已通过</span>';
                        // 移除审核按钮，只保留查看按钮
                        const viewBtn = actionCell.querySelector('.action-btn.view');
                        actionCell.innerHTML = '';
                        if (viewBtn) {
                            actionCell.appendChild(viewBtn);
                        }
                    } else if (status === 'rejected') {
                        statusCell.innerHTML = '<span class="badge badge-danger">已拒绝</span>';
                        // 移除审核按钮，只保留查看按钮
                        const viewBtn = actionCell.querySelector('.action-btn.view');
                        actionCell.innerHTML = '';
                        if (viewBtn) {
                            actionCell.appendChild(viewBtn);
                        }
                    }
                }
            });
            
            // 更新审核管理页面中的审核项
            const auditItems = document.querySelectorAll('.audit-item');
            auditItems.forEach(item => {
                const approveBtn = item.querySelector('.action-btn.approve');
                if (approveBtn && approveBtn.getAttribute('data-student-id') === studentId) {
                    if (status === 'approved') {
                        // 更新审核项状态为已通过
                        const actionsContainer = item.querySelector('.audit-actions');
                        actionsContainer.innerHTML = `
                            <span class="badge badge-success" style="padding: 8px 12px; font-size: 0.9rem;">已通过</span>
                            <button class="action-btn view" data-student-id="${studentId}" data-student-name="${approveBtn.getAttribute('data-student-name')}" title="查看详情">
                                <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" style="margin-right: 5px;">
                                    <path d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z" />
                                </svg>
                                查看详情
                            </button>
                        `;
                    } else if (status === 'rejected') {
                        // 更新审核项状态为已拒绝
                        const actionsContainer = item.querySelector('.audit-actions');
                        actionsContainer.innerHTML = `
                            <span class="badge badge-danger" style="padding: 8px 12px; font-size: 0.9rem;">已拒绝</span>
                            <button class="action-btn view" data-student-id="${studentId}" data-student-name="${approveBtn.getAttribute('data-student-name')}" title="查看详情">
                                <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" style="margin-right: 5px;">
                                    <path d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z" />
                                </svg>
                                查看详情
                            </button>
                        `;
                    }
                }
            });
        }
        
        updateStatistics(action) {
            // 更新页面统计数据
            const pendingCard = document.querySelector('.stat-card:nth-child(3) .stat-value');
            if (pendingCard) {
                const current = parseInt(pendingCard.textContent);
                pendingCard.textContent = current - 1;
            }
            
            if (action === 'approve') {
                const verifiedCard = document.querySelector('.stat-card:nth-child(2) .stat-value');
                if (verifiedCard) {
                    const current = parseInt(verifiedCard.textContent.replace(/,/g, ''));
                    verifiedCard.textContent = (current + 1).toLocaleString();
                }
            }
        }
        
        recordAuditHistory(studentId, action, comment) {
            // 这里可以记录审核历史到数据库或本地存储
            const now = new Date().toLocaleString();
            console.log(`审核记录: ${studentId} - ${action} - ${now} - ${comment}`);
        }
        
        getStudentDetailData(studentId, studentName) {
            // 模拟获取学生详细数据
            const mockData = {
                '2020010001': {
                    id: '2020010001',
                    name: '张三',
                    gender: '男',
                    idCard: '110101199001011234',
                    college: '计算机学院',
                    major: '计算机科学与技术',
                    degree: '本科',
                    duration: '4年',
                    admission: '2020年',
                    graduation: '2024年',
                    status: '已上链',
                    txHash: '0x7d6a5743a5ef92d8e44f5a8d17d31cb94c7ede087c10e2f498dfccfe8de4babd',
                    blockHeight: '1,246,783',
                    blockchainTime: '2024-05-20 14:30:22',
                    auditHistory: [
                        { type: '信息录入', operator: 'admin', time: '2024-04-01 10:15', note: '初始信息录入' },
                        { type: '信息修改', operator: '王老师', time: '2024-04-15 09:30', note: '更新专业信息' },
                        { type: '审核通过', operator: '李主任', time: '2024-05-20 14:30', note: '学历信息审核通过' }
                    ]
                },
                                 '2020010002': {
                     id: '2020010002',
                     name: '李四',
                     gender: '女',
                     idCard: '110101199001021234',
                     college: '计算机学院',
                     major: '软件工程',
                     degree: '本科',
                     duration: '4年',
                     admission: '2020年',
                     graduation: '2024年',
                     status: '待审核',
                     txHash: '-',
                     blockHeight: '-',
                     blockchainTime: '-',
                     auditHistory: [
                         { type: '信息录入', operator: 'admin', time: '2024-04-01 10:15', note: '初始信息录入' }
                     ]
                 },
                 '2021010003': {
                     id: '2021010003',
                     name: '王五',
                     gender: '男',
                     idCard: '110101199101011234',
                     college: '管理学院',
                     major: '工商管理',
                     degree: '本科',
                     duration: '4年',
                     admission: '2021年',
                     graduation: '2025年',
                     status: '待审核',
                     txHash: '-',
                     blockHeight: '-',
                     blockchainTime: '-',
                     auditHistory: [
                         { type: '信息录入', operator: 'admin', time: '2024-03-15 14:20', note: '初始信息录入' },
                         { type: '信息修改', operator: '张老师', time: '2024-04-10 11:30', note: '修正毕业年份' }
                     ]
                 }
            };
            
            return mockData[studentId] || {
                id: studentId,
                name: studentName,
                gender: '-',
                idCard: '-',
                college: '-',
                major: '-',
                degree: '-',
                duration: '-',
                admission: '-',
                graduation: '-',
                status: '-',
                txHash: '-',
                blockHeight: '-',
                blockchainTime: '-',
                auditHistory: []
            };
        }
        
        fillDetailModal(data) {
            // 存储当前学生数据以便下载证书功能使用
            this.currentStudentData = { studentId: data.id, studentName: data.name };
            
            document.getElementById('detail-student-id').textContent = data.id;
            document.getElementById('detail-student-name').textContent = data.name;
            document.getElementById('detail-student-gender').textContent = data.gender;
            document.getElementById('detail-student-idcard').textContent = data.idCard;
            document.getElementById('detail-student-college').textContent = data.college;
            document.getElementById('detail-student-major').textContent = data.major;
            document.getElementById('detail-student-degree').textContent = data.degree;
            document.getElementById('detail-student-duration').textContent = data.duration;
            document.getElementById('detail-student-admission').textContent = data.admission;
            document.getElementById('detail-student-graduation').textContent = data.graduation;
            
            // 填充区块链信息
            document.getElementById('detail-tx-hash').textContent = data.txHash;
            document.getElementById('detail-block-height').textContent = data.blockHeight;
            document.getElementById('detail-blockchain-time').textContent = data.blockchainTime;
            
            const statusBadge = document.getElementById('detail-status');
            statusBadge.textContent = data.status;
            statusBadge.className = 'badge';
            if (data.status === '已上链') {
                statusBadge.classList.add('badge-success');
            } else if (data.status === '待审核') {
                statusBadge.classList.add('badge-warning');
            } else if (data.status === '已拒绝') {
                statusBadge.classList.add('badge-danger');
            }
            
            // 填充审核历史
            const historyTBody = document.getElementById('detail-audit-history');
            historyTBody.innerHTML = '';
            data.auditHistory.forEach(record => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${record.type}</td>
                    <td>${record.operator}</td>
                    <td>${record.time}</td>
                    <td>${record.note}</td>
                `;
                historyTBody.appendChild(row);
            });
        }
        
        downloadCertificate() {
            if (this.currentStudentData) {
                // 模拟下载证书
                this.showNotification('证书下载已开始...', 'success');
                
                // 创建一个简单的HTML证书
                const certificateContent = `
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <meta charset="UTF-8">
                        <title>学历证书</title>
                        <style>
                            body { font-family: 'SimSun', serif; text-align: center; padding: 50px; }
                            .certificate { border: 5px solid #3A7BD5; padding: 40px; margin: 20px auto; max-width: 600px; }
                            .title { font-size: 28px; font-weight: bold; margin-bottom: 30px; color: #3A7BD5; }
                            .content { font-size: 18px; line-height: 2; margin: 20px 0; }
                            .signature { margin-top: 50px; text-align: right; }
                        </style>
                    </head>
                    <body>
                        <div class="certificate">
                            <div class="title">学历证书</div>
                            <div class="content">
                                兹证明 <strong>${this.currentStudentData.studentName}</strong> 同学<br/>
                                已完成学业要求，准予毕业。<br/>
                                学号：${this.currentStudentData.studentId}<br/>
                                颁发日期：${new Date().toLocaleDateString()}
                            </div>
                            <div class="signature">
                                学链通大学<br/>
                                ${new Date().getFullYear()}年
                            </div>
                        </div>
                    </body>
                    </html>
                `;
                
                const blob = new Blob([certificateContent], { type: 'text/html;charset=utf-8' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = `${this.currentStudentData.studentName}_学历证书.html`;
                link.click();
                URL.revokeObjectURL(link.href);
            }
        }
        
        showModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            }
        }
        
        hideModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        }
        
        showNotification(message, type = 'info') {
            // 创建通知元素
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // 3秒后自动移除
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 3000);
        }
    }
    </script>
    
    <!-- 额外样式 -->
    <style>
    /* 快速操作卡片 */
    .quick-action-card {
        background: white;
        border-radius: 8px;
        padding: 20px;
        text-align: center;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
        cursor: pointer;
        border: 1px solid #e0e0e0;
    }
    
    .quick-action-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }
    
    .quick-action-icon {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: linear-gradient(45deg, #3A7BD5, #00d2ff);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 15px;
    }
    
    .quick-action-card h3 {
        font-size: 1.1rem;
        margin-bottom: 8px;
        color: #2c3e50;
    }
    
    .quick-action-card p {
        font-size: 0.9rem;
        color: #546e7a;
        margin: 0;
    }
    
    /* 证书网格 */
    .certificate-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }
    
    .certificate-item {
        background: white;
        border-radius: 8px;
        padding: 20px;
        text-align: center;
        border: 1px solid #e0e0e0;
        transition: all 0.3s ease;
    }
    
    .certificate-item:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }
    
    .certificate-item h3 {
        margin-bottom: 10px;
        color: #2c3e50;
    }
    
    .certificate-item p {
        color: #546e7a;
        margin-bottom: 15px;
    }
    
    /* 上传历史 */
    .upload-history {
        margin-top: 30px;
    }
    
    .upload-history h3 {
        margin-bottom: 15px;
        color: #2c3e50;
    }
    
    /* 审核列表 */
    .audit-list {
        margin-top: 20px;
    }
    
    .audit-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        margin-bottom: 15px;
        background: white;
    }
    
    .audit-info h4 {
        margin-bottom: 8px;
        color: #2c3e50;
    }
    
    .audit-info p {
        margin: 0;
        color: #546e7a;
        font-size: 0.9rem;
    }
    
    .audit-actions {
        display: flex;
        gap: 10px;
    }
    
    /* 审核按钮样式 */
    .action-btn.approve {
        background-color: #28a745;
        color: white;
        border: 1px solid #28a745;
    }
    
    .action-btn.approve:hover {
        background-color: #218838;
        border-color: #1e7e34;
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(40, 167, 69, 0.3);
    }
    
    .action-btn.reject {
        background-color: #dc3545;
        color: white;
        border: 1px solid #dc3545;
    }
    
    .action-btn.reject:hover {
        background-color: #c82333;
        border-color: #bd2130;
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(220, 53, 69, 0.3);
    }
    
    .action-btn.view:hover {
        background-color: #3A7BD5;
        color: white;
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(58, 123, 213, 0.3);
    }
    
    .action-btn.edit:hover {
        background-color: #ffc107;
        color: #212529;
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(255, 193, 7, 0.3);
    }
    
    /* 图表容器 */
    .chart-container {
        background: white;
        border-radius: 15px;
        padding: 2rem;
        box-shadow: 0 5px 20px rgba(58, 123, 213, 0.08);
        border: 1px solid rgba(58, 123, 213, 0.05);
        margin-bottom: 2rem;
        transition: all 0.3s ease;
    }
    
    .chart-container:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 30px rgba(58, 123, 213, 0.15);
    }
    
    .chart-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid #f0f0f0;
    }
    
    .chart-title {
        font-size: 1.2rem;
        font-weight: 600;
        color: #333;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }
    
    .chart-title svg {
        color: #3A7BD5;
    }
    
    .time-selector {
        display: flex;
        gap: 0.5rem;
        background: #f8f9fa;
        border-radius: 8px;
        padding: 0.3rem;
    }
    
    .time-btn {
        padding: 0.4rem 0.8rem;
        border: none;
        border-radius: 6px;
        font-size: 0.8rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s ease;
        background: transparent;
        color: #666;
    }
    
    .time-btn.active {
        background: linear-gradient(135deg, #3A7BD5, #00d2ff);
        color: white;
        box-shadow: 0 2px 8px rgba(58, 123, 213, 0.3);
    }
    
    .time-btn:hover:not(.active) {
        background: rgba(58, 123, 213, 0.1);
        color: #3A7BD5;
    }
    
    .chart-wrapper {
        position: relative;
        display: flex;
        align-items: center;
    }
    
    .chart-canvas {
        width: 100%;
        border-radius: 8px;
        cursor: crosshair;
    }
    
    .chart-y-labels {
        position: absolute;
        left: 10px;
        top: 0;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        font-size: 12px;
        color: #666;
        padding: 20px 0;
    }
    
    .chart-labels {
        display: flex;
        justify-content: space-between;
        padding: 0 60px;
        margin-top: 10px;
        font-size: 12px;
        color: #666;
    }
    
    .chart-tooltip {
        position: absolute;
        background: linear-gradient(135deg, #3A7BD5, #00d2ff);
        color: white;
        padding: 0.5rem 0.8rem;
        border-radius: 8px;
        font-size: 0.8rem;
        font-weight: 500;
        pointer-events: none;
        opacity: 0;
        transition: opacity 0.3s ease;
        box-shadow: 0 4px 12px rgba(58, 123, 213, 0.3);
        z-index: 1000;
    }
    
    .chart-tooltip.visible {
        opacity: 1;
    }
    
    .chart-legend {
        margin-top: 1rem;
        padding-top: 1rem;
        border-top: 1px solid #f0f0f0;
    }
    
    .chart-placeholder {
        height: 200px;
        background: #f8f9fa;
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #546e7a;
    }
    
    /* 报表表格 */
    .report-table {
        margin-top: 20px;
    }
    
    .report-table h3 {
        margin-bottom: 15px;
        color: #2c3e50;
    }
    
    /* 状态项 */
    .status-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 0;
        border-bottom: 1px solid #e0e0e0;
    }
    
    .status-item:last-child {
        border-bottom: none;
    }
    
    /* 拖拽状态 */
    .upload-zone.dragover {
        border-color: #3A7BD5;
        background-color: rgba(58, 123, 213, 0.05);
    }
    
    /* 上传进度条 */
    .progress-bar {
        width: 100%;
        height: 8px;
        background-color: #e9ecef;
        border-radius: 4px;
        overflow: hidden;
    }
    
    .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #3A7BD5, #00d2ff);
        border-radius: 4px;
        transition: width 0.3s ease;
        width: 0%;
    }
    
    /* 文件预览表格 */
    #previewTable table {
        font-size: 0.9rem;
    }
    
    #previewTable th {
        background-color: #f8f9fa;
        font-weight: 600;
        white-space: nowrap;
    }
    
    #previewTable td {
        white-space: nowrap;
        max-width: 120px;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    
    /* 验证结果样式 */
    .validation-success {
        color: #28a745;
        font-weight: 500;
    }
    
    .validation-error {
        color: #dc3545;
        font-weight: 500;
    }
    
    .validation-warning {
        color: #ffc107;
        font-weight: 500;
    }
    
    .validation-item {
        display: flex;
        align-items: center;
        margin-bottom: 8px;
        padding: 8px;
        border-radius: 4px;
        background: rgba(0,0,0,0.02);
    }
    
    .validation-item svg {
        margin-right: 8px;
        flex-shrink: 0;
    }
    
    /* 上传状态指示器 */
    .upload-status {
        position: absolute;
        top: 15px;
        right: 15px;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background-color: #28a745;
        animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.5; }
        100% { opacity: 1; }
    }
    
    /* 通知样式 */
    .notification {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 15px 20px;
        border-radius: 5px;
        color: white;
        font-weight: 500;
        z-index: 10000;
        animation: slideIn 0.3s ease;
    }
    
    .notification.success {
        background-color: #00c853;
    }
    
    .notification.error {
        background-color: #f44336;
    }
    
    .notification.warning {
        background-color: #ff9800;
    }
    
    @keyframes slideIn {
        from {
            transform: translateX(100%);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }
    
    /* 响应式设计 */
    @media (max-width: 768px) {
        .audit-item {
            flex-direction: column;
            align-items: flex-start;
            gap: 15px;
        }
        
        .audit-actions {
            width: 100%;
            justify-content: flex-end;
        }
        
        .certificate-grid {
            grid-template-columns: 1fr;
        }
    }
    </style>
</body>
</html> 